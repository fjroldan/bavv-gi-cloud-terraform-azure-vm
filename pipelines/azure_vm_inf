pipeline {
	// Define the agent
    agent { label 'production_agent' }
    // Define the staging
	stages {
        
		stage ("Terraform init") {
			steps {
				sh ('terraform init -upgrade')
			}
		}
        stage ("Terraform validate") {
			steps {
				sh ('terraform validate')
			}
		}
        stage ("Terraform plan") {
			steps {
				sh ('terraform plan -var-file example.auto.tfvars.json')
			}
		}
        stage ("Terraform apply") {
			steps {
				sh ('terraform apply -var-file example.auto.tfvars.json -auto-approve')
			}
		}
	}
}